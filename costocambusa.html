<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Costo Cambusa - Reparto Maori</title>
    <meta name="description" content="Calcolo costi cambusa Reparto Maori" />
    <meta name="theme-color" content="#16a34a" />

    <!-- Favicon e icone -->
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" href="icon-192.png" />

    <!-- Manifest PWA -->
    <link rel="manifest" href="manifest.json" />

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js"></script>
</head>

<body class="bg-gray-100 flex flex-col min-h-screen">
    <div id="app" class="max-w-4xl mx-auto w-full bg-white shadow-lg rounded-xl overflow-hidden my-1.5">
        <!-- Header condiviso -->
        <div id="shared-header"></div>

        <!-- Main -->
        <main id="main-content" class="p-6">
            <!-- Modali condivisi -->
            <div id="shared-modals"></div>

            <!-- Contenuto Costo Cambusa -->
            <section id="costoCambusaTab" class="tab-content active">
                <h2 class="text-2xl font-semibold text-gray-700 mb-6">Calcolo Costo Cambusa</h2>

                <div class="grid md:grid-cols-2 gap-6">

                    <!-- Colonna 1: Configurazione -->
                    <div class="space-y-6">
                        <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                            <h3 class="text-xl font-semibold text-gray-700 mb-4">Configurazione</h3>
                            <form id="configForm" class="space-y-4">
                                <div>
                                    <label for="selectActivity"
                                        class="block text-sm font-medium text-gray-700 mb-1">Attivit√†</label>
                                    <select id="selectActivity"
                                        class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-200">
                                        <option value="">Seleziona un'attivit√†...</option>
                                    </select>
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label for="staffCount"
                                            class="block text-sm font-medium text-gray-700 mb-1">Staff</label>
                                        <input type="number" id="staffCount" min="0" value="0"
                                            class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-200" />
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Esploratori</label>
                                        <input type="text" id="scoutsCountDisplay" disabled
                                            class="w-full rounded-lg bg-gray-200 border-gray-300 text-gray-600 cursor-not-allowed"
                                            value="0">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Colonna 2: Impostazioni Costo e Gara -->
                    <div class="space-y-6">
                        <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                            <h3 class="text-xl font-semibold text-gray-700 mb-4">Budget Cambusa</h3>

                            <!-- Modalit√† Calcolo -->
                            <div class="flex gap-4 mb-6">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="calcMode" value="meal" checked
                                        class="text-green-600 focus:ring-green-500">
                                    <span class="text-sm font-medium text-gray-700">Per Pasto</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="calcMode" value="day"
                                        class="text-green-600 focus:ring-green-500">
                                    <span class="text-sm font-medium text-gray-700">Per Giorno</span>
                                </label>
                            </div>

                            <!-- Inputs Dinamici -->
                            <div class="space-y-4">
                                <div>
                                    <label id="quantityLabel" for="quantityInput"
                                        class="block text-sm font-medium text-gray-700 mb-1">Numero Pasti</label>
                                    <input type="number" id="quantityInput" min="0" value="0"
                                        class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-200" />
                                </div>

                                <div>
                                    <label id="rateLabel" for="rateInput"
                                        class="block text-sm font-medium text-gray-700 mb-1">Costo per Pasto (‚Ç¨)</label>
                                    <input type="number" id="rateInput" min="0" step="0.01" placeholder="0.00"
                                        class="w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-200" />
                                </div>

                                <!-- Helper for Day Mode deduction -->
                                <div id="mealsPerDayContainer" class="hidden">
                                    <label class="block text-xs text-gray-500 mb-1">Pasti al giorno (per calcolo
                                        deduzione gara)</label>
                                    <input type="number" id="mealsPerDay" value="3" min="1"
                                        class="w-20 rounded border-gray-300 text-sm p-1">
                                </div>
                            </div>

                            <div class="pt-4 border-t border-gray-200 mt-6">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-medium text-gray-700">Subtotale Cibo:</span>
                                    <span id="foodSubtotal" class="font-bold text-gray-900">‚Ç¨ 0.00</span>
                                </div>
                                <div id="deductionDisplay"
                                    class="hidden flex justify-between items-center text-xs text-red-600 mt-1">
                                    <span>Deduzione Pasto Gara:</span>
                                    <span id="deductionAmount">- ‚Ç¨ 0.00</span>
                                </div>
                                <div id="garaAddDisplay"
                                    class="hidden flex justify-between items-center text-xs text-orange-600 mt-1">
                                    <span>Budget Gara:</span>
                                    <span id="garaAddAmount">+ ‚Ç¨ 0.00</span>
                                </div>
                            </div>
                        </div>

                        <!-- Gara di Cucina -->
                        <div
                            class="bg-orange-50 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-800 p-6 rounded-lg shadow-inner">
                            <h3
                                class="text-lg font-semibold text-orange-800 dark:text-orange-200 mb-4 flex items-center gap-2">
                                <span>üë®‚Äçüç≥</span> Gara di Cucina
                            </h3>
                            <div class="space-y-4">
                                <div class="flex items-center gap-2">
                                    <input type="checkbox" id="cookingCompActive"
                                        class="rounded border-orange-300 text-orange-600 shadow-sm focus:ring-orange-200" />
                                    <label for="cookingCompActive"
                                        class="text-sm font-medium text-orange-900 dark:text-orange-100">Gara di
                                        cucina presente</label>
                                </div>
                                <p class="text-xs text-orange-700 dark:text-orange-300">
                                    Se attiva, il costo di 1 pasto standard viene dedotto dal budget normale e
                                    sostituito con il budget della gara.
                                </p>

                                <div id="cookingCompInputs" class="hidden space-y-3 pt-2">
                                    <div>
                                        <label for="cookingCompBudget"
                                            class="block text-sm font-medium text-orange-900 dark:text-orange-100 mb-1">Budget
                                            Totale Gara (‚Ç¨)</label>
                                        <input type="number" id="cookingCompBudget" min="0" step="0.01"
                                            placeholder="0.00"
                                            class="w-full rounded-lg border-orange-300 shadow-sm focus:border-orange-500 focus:ring-orange-200 text-gray-900" />
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

                <!-- Totale Finale -->
                <div
                    class="mt-8 bg-blue-50 dark:bg-slate-800 p-6 rounded-xl border border-blue-200 dark:border-slate-700 shadow-sm">
                    <h3 class="text-lg font-semibold text-blue-900 dark:text-blue-100 mb-4">Riepilogo Costo Cambusa</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-end">
                        <div>
                            <p class="text-sm text-blue-700 dark:text-blue-300 mb-2">Il budget totale include cibo e
                                gara
                                di cucina. Diviso sugli esploratori.</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Esploratori: <span id="summaryScouts"
                                    class="font-bold text-gray-900 dark:text-white">0</span></p>
                        </div>
                        <div class="text-right space-y-2">
                            <div class="flex justify-between md:justify-end md:gap-8 items-end">
                                <span class="text-gray-600 dark:text-gray-400 text-sm uppercase tracking-wider">Totale
                                    Complessivo</span>
                                <span id="grandTotal" class="text-2xl font-bold text-gray-900 dark:text-white">‚Ç¨
                                    0,00</span>
                            </div>
                            <div
                                class="flex justify-between md:justify-end md:gap-8 items-end border-t border-blue-200 dark:border-slate-600 pt-2">
                                <span class="text-blue-800 dark:text-blue-200 font-semibold">Quota per
                                    Esploratore</span>
                                <span id="perPersonTotal" class="text-3xl font-bold text-blue-700 dark:text-blue-400">‚Ç¨
                                    0,00</span>
                            </div>
                        </div>
                    </div>
                </div>

            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/config.js"></script>
    <script type="module" src="shared.js"></script>
    <script type="module" src="costocambusa.js"></script>
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("sw.js")
                .catch(err => console.error("SW registration failed:", err));
        }
    </script>
</body>

</html>